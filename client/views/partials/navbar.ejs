<nav class="navbar">
    <a href="/" class="logo">
        <i class="fas fa-train"></i> Chilahati
    </a>
    <div class="nav-links">
        <a href="/" class="nav-item">Home</a>

        <!-- DROPDOWN MENU -->
        <div class="dropdown">
            <a href="#" class="nav-item">Categories <i class="fas fa-chevron-down"
                    style="font-size: 0.8em; margin-left: 5px;"></i></a>
            <div class="dropdown-menu">
                <a href="#" class="dropdown-item"><i class="fas fa-history"></i> History</a>
                <a href="#" class="dropdown-item"><i class="fas fa-palette"></i> Culture</a>
                <a href="#" class="dropdown-item"><i class="fas fa-university"></i> Institutions</a>
                <a href="#" class="dropdown-item"><i class="fas fa-users"></i> Notable People</a>
                <a href="#" class="dropdown-item"><i class="fas fa-graduation-cap"></i> Local Scholars</a>
                <a href="#" class="dropdown-item"><i class="fas fa-train"></i> Transport</a>
                <a href="#" class="dropdown-item"><i class="fas fa-camera-retro"></i> Tourist Spots</a>
                <a href="#" class="dropdown-item"><i class="fas fa-ambulance"></i> Emergency</a>
                <a href="#" class="dropdown-item"><i class="fas fa-hands-helping"></i> Social Work</a>
                <a href="#" class="dropdown-item"><i class="fas fa-map-marked-alt"></i> Interactive Map</a>
            </div>
        </div>

        <a href="#" class="nav-item">Contribute</a>
        <a href="#" class="nav-item">Contact</a>
        <a href="#" class="nav-item">About Us</a>
    </div>

    <div class="nav-actions">
        <button id="theme-toggle" class="theme-toggle-btn" title="Toggle Dark Mode">
            <i class="fas fa-moon"></i>
        </button>
        <div class="search-box">
            <input type="text" class="search-txt" placeholder="Search...">
            <button class="search-btn-icon"><i class="fas fa-search"></i></button>
        </div>

        <!-- AUTH BUTTONS LOGIC -->
        <% if (!user) { %>
            <a href="/login" class="login-btn">Login</a>
            <a href="/register" class="register-btn">Register</a>
            <% } else { %>
                <!-- NEW: Admin/Supervisor Menu -->
                <% if (user.role==='admin' || user.role==='supervisor' ) { %>
                    <a href="/admin/add" class="nav-item" style="color: #ffda79;"><i class="fas fa-plus-circle"></i> Add
                        Content</a>
                    <% } %>

                        <a href="/profile" class="nav-item">Hi, <%= user.username %></a>
                        <a href="/logout" class="login-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem;">Logout</a>
                        <% } %>
    </div>
</nav>

<!-- THEME TOGGLE SCRIPT (Now lives here!) -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const themeToggleBtn = document.getElementById('theme-toggle');
        const body = document.body;
        const icon = themeToggleBtn.querySelector('i');

        // 1. Check LocalStorage on load (Memory)
        const currentTheme = localStorage.getItem('theme');
        if (currentTheme === 'dark') {
            body.classList.add('dark-mode');
            icon.classList.remove('fa-moon');
            icon.classList.add('fa-sun');
        }

        // 2. Handle Click
        themeToggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');

            if (body.classList.contains('dark-mode')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
                localStorage.setItem('theme', 'dark'); // Save to memory
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
                localStorage.setItem('theme', 'light'); // Save to memory
            }
        });
    });
</script>