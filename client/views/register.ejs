<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Chilahati Archive</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>

    <%- include('partials/navbar') %>

        <div class="auth-container">
            <div class="auth-card">
                <h2>Join the Community</h2>
                <!-- ERROR MESSAGE ALERT -->
                <% if (error_msg && error_msg.length> 0) { %>
                    <div
                        style="background: rgba(255, 107, 107, 0.2); border: 1px solid #ff6b6b; color: #ff6b6b; padding: 10px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                        <i class="fas fa-exclamation-circle"></i>
                        <%= error_msg %>
                    </div>
                    <% } %>
                
                        <!-- SUCCESS MESSAGE ALERT -->
                        <% if (success_msg && success_msg.length> 0) { %>
                            <div
                                style="background: rgba(46, 204, 113, 0.2); border: 1px solid #2ecc71; color: #2ecc71; padding: 10px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                                <i class="fas fa-check-circle"></i>
                                <%= success_msg %>
                            </div>
                            <% } %>
                <form action="/register" method="POST" id="registerForm">

                    <!-- Username Field -->
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" class="form-control"
                            placeholder="Choose a username" required>
                    </div>

                    <!-- Email Field -->
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" class="form-control" placeholder="name@example.com"
                            required>
                    </div>

                    <!-- Password Field -->
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" class="form-control"
                            placeholder="Min. 8 characters" minlength="8" required>
                    </div>

                    <!-- Confirm Password Field -->
                    <div class="form-group">
                        <label for="confirm_password">Confirm Password</label>
                        <input type="password" id="confirm_password" name="confirm_password" class="form-control"
                            placeholder="Re-enter password" required>
                        <small id="passwordError" style="color: #ff6b6b; display: none; margin-top: 5px;">Passwords do
                            not match!</small>
                    </div>

                    <button type="submit" class="btn-block">Create Account</button>
                </form>

                <div class="auth-footer">
                    Already have an account?
                    <a href="/login" class="auth-link">Login here</a>
                </div>
            </div>
        </div>

        <%- include('partials/footer') %>

            <script>
                // 1. Theme Toggle Logic
                const themeToggleBtn = document.getElementById('theme-toggle');
                const body = document.body;
                const icon = themeToggleBtn.querySelector('i');
                themeToggleBtn.addEventListener('click', () => {
                    body.classList.toggle('dark-mode');
                    if (body.classList.contains('dark-mode')) {
                        icon.classList.remove('fa-moon');
                        icon.classList.add('fa-sun');
                    } else {
                        icon.classList.remove('fa-sun');
                        icon.classList.add('fa-moon');
                    }
                });

                // 2. Client-Side Password Matching Validation
                const form = document.getElementById('registerForm');
                const password = document.getElementById('password');
                const confirmPassword = document.getElementById('confirm_password');
                const errorMsg = document.getElementById('passwordError');

                form.addEventListener('submit', (e) => {
                    if (password.value !== confirmPassword.value) {
                        e.preventDefault(); // Stop the form from sending to server
                        errorMsg.style.display = 'block';
                        confirmPassword.style.borderColor = '#ff6b6b';
                    }
                });

                // Clear error when user starts typing again
                confirmPassword.addEventListener('input', () => {
                    errorMsg.style.display = 'none';
                    confirmPassword.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                });
            </script>
</body>

</html>